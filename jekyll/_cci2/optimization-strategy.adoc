= Optimization Strategies
:page-layout: classic-docs
:page-liquid:
:icons: font
:toc: macro
:toc-title:
:sectanchors:

**TO DO: THIS SECTION IS GOING TO END UP AS A RECIPE IN THE OPTIMIZATION COOKBOOK:**

.Deployment Frequency
image::deploy.png[Deployment Frequency]

==Deployment Frequency

Providing value to your customers is the top goal for any organization, and one can measure the performance of an organization by how often (frequency) value is delivered (deployment). High-performing teams deploy value to customers multiple times per day according to the DevOps Research and Assessment Report, 2019.

While many organizations deploy value to customer once per quarter or once per month, the basics of decreasing this frequency to once per week or once per day is represented by the same type of orchestration added to an organization's value *pipeline*.

To deploy multiple times per day, developers need an automated workflow that enables them to test their changes on a branch of code that matches exactly the environment of master, without being on the master branch. This is possible with the use of workflow orchestration in your continuous integration suite.

.Workflows
Image::workflows-no-deploy.png[Workflows]

When you provide developers with workflow that runs all of their tests in the master environment, but doesn't run a deploy, they can safely test and debug their code on a branch until all tests are passing.

.Workflows
Image::workflows-yes-deploy.png[Workflows]

A workflow that runs all tests *as if they were on master* gives developers the confidence they need to merge to master knowing their code will not break or cause an outage or interruption to service for customers. The small investment in configuring such a workflow is well-worth the increase in deployment frequency of valuable changes to your customers. 

A simple example would configure deployment to run *only* if a change is merged to master and the test jobs have already passed. 

For an organization deploying multiple times per day, that configuration may be as simple as the following snippet of YAML:

[source,yaml]
----
- deploy:
    requires:
      - build
    filters:
      branches:
        only: master
----

The time difference in your organization's frequency *without* a workflow to enable developers in the way described above will include the time it takes for them to ensure their environment is the same as production, plus the time to run all of the same tests to ensure their code is good. All environment updates and tests must also be completed by every developer before any other changes are made to master. If changes happen *on master* while they are updating their environment or running their own tests, they will have to rerun everything to have confidence that their code won't break. 

For an organization deploying on a slower cadence, a nightly build workflow can ensure that on any day an update is needed by customers, there is a tested and deployable build available:

[source,yaml]
----
nightly-build:
  triggers:
    - schedule:
        cron: '0 8 ***'
        filters:
          branches:
            only: master
----

The time difference includes the lag described above plus the duration of the pipeline run and elapsed time between when a developer finished a change and when the scheduled build runs. All of this time adds up and the more confidence developers have in the quality of their code the higher their deployment frequency.


